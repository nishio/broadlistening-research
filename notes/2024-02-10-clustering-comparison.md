# クラスタリング手法の比較実験

## 目的
- k-meansとHDBSCANのクラスタリング結果を比較
- クラスタ数とクラスタサイズの分布を分析

## 実験手順
1. HDBSCANクラスタリングの実行
   - パラメータ: min_cluster_size=5, max_cluster_size=30, min_samples=2
   - 結果の保存: experiments/results/hdbscan_detailed_metrics.csv

2. HDBSCANの結果に基づくk-meansクラスタリング
   - 同じクラスタ数のk-means
   - 同じ平均クラスタサイズのk-means
   - 結果の保存: experiments/results/kmeans_same_n_metrics.csv, kmeans_same_size_metrics.csv

3. メトリクスの比較と可視化
   - size: クラスタサイズの分布
   - avg_distance: クラスタ内の平均距離
   - max_distance: クラスタ内の最大距離
   - density: クラスタの密度

## 実験結果

### HDBSCANクラスタリング
- クラスタ数: 66
- 平均クラスタサイズ: 8.06
- ノイズポイントの数: 9351
- 有効なデータポイント数: 532（全9883ポイント中）

### k-meansクラスタリング（同じクラスタ数）
- クラスタ数: 66
- データポイント数: 9883（ノイズポイントなし）
- 平均クラスタサイズ: 149.74（9883/66）

### k-meansクラスタリング（同じ平均サイズ）
- クラスタ数: 1226
- データポイント数: 9883（ノイズポイントなし）
- 平均クラスタサイズ: 8.06（9883/1226）

### メトリクスの比較
各メトリクスの分布をヒストグラムで可視化しました：

1. クラスタサイズの分布
   ![クラスタサイズの分布](../experiments/results/size_histogram.png)
   - HDBSCANは小さなクラスタ（5-22ポイント）を多く生成
   - k-means（同じクラスタ数）は均一なサイズのクラスタを生成
   - k-means（同じ平均サイズ）はHDBSCANに近い分布を示す

2. クラスタ内の平均距離
   ![平均距離の分布](../experiments/results/avg_distance_histogram.png)
   - クラスタ内の点同士の平均距離を示す
   - 小さいほど密集したクラスタを表す

3. クラスタ内の最大距離
   ![最大距離の分布](../experiments/results/max_distance_histogram.png)
   - クラスタの直径に相当
   - 大きいほどクラスタが広がっていることを示す

4. クラスタの密度
   ![密度の分布](../experiments/results/density_histogram.png)
   - 平均距離の逆数として定義
   - 大きいほど密集したクラスタを表す

## 考察
1. HDBSCANの特徴
   - 小さな密集したクラスタを検出
   - データの94.6%（9351/9883）をノイズとして分類
   - 残りの5.4%のデータを66の明確なクラスタに分類

2. k-means（同じクラスタ数）の特徴
   - 全データポイントを66クラスタに均等に分配
   - クラスタサイズが比較的均一
   - ノイズの概念がないため、全データポイントをいずれかのクラスタに割り当て

3. k-means（同じ平均サイズ）の特徴
   - HDBSCANの平均クラスタサイズ（8.06）に合わせて1226クラスタを生成
   - より細かい粒度でのクラスタリングを実現
   - クラスタサイズの分布がHDBSCANに近い

## 結論
- HDBSCANは密集した明確なクラスタのみを抽出し、大部分のデータをノイズとして分類
- k-meansは全データポイントを指定された数のクラスタに分配
- クラスタ数とクラスタサイズのトレードオフが存在することが確認された
